(window.webpackJsonp=window.webpackJsonp||[]).push([[155],{433:function(e,t,a){"use strict";a.r(t);var n=a(1),r=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"上传头像的三种方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#上传头像的三种方法"}},[e._v("#")]),e._v(" 上传头像的三种方法")]),e._v(" "),a("h2",{attrs:{id:"一、form表单上传文件-原生js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、form表单上传文件-原生js"}},[e._v("#")]),e._v(" 一、form表单上传文件(原生JS)")]),e._v(" "),a("h3",{attrs:{id:"_1、html部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、html部分"}},[e._v("#")]),e._v(" 1、HTML部分")]),e._v(" "),a("pre",[a("code",[e._v('<img id="img-box" style="border: 1px solid gray; width: 100px; height: 100px;" src=""/>\n\n<form action="http://192.168.0.3/project/artist-v2/api/index.php" method="post" enctype="multipart/form-data">\n    <input type="hidden" name="m" id="m" value="user" />\n    <input type="hidden" name="a" id="a" value="changeHeadImage" />\n    <input type="hidden" name="userId" id="userId" value="1" />\n    <input type="file" name="newHeadImage" id="newHeadImage" value="" />\n    <input type="submit" value="提交"/>\n</form>\n')])]),e._v(" "),a("h3",{attrs:{id:"_2、js部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、js部分"}},[e._v("#")]),e._v(" 2、JS部分")]),e._v(" "),a("pre",[a("code",[e._v('<script type="text/javascript">\n    var tag = document.querySelector("#newHeadImage");\n    tag.addEventListener("change",function(){\n        //1、input file类型的标签中, 所有的文件放在files属性中, 这个属性是个数组\n        if(tag.files.length == 0){\n            alert("没有选择图片")\n            return\n        }\n        var uploadFile = tag.files[0];\n        \n        //2、从文件对象获取本地路径src\n        var src = window.URL.createObjectURL(uploadFile)\n        \n        //3、显示图片\n        var imgBox = document.getElementById("img-box")\n        imgBox.src = src;\n    })\n<\/script>\n')])]),e._v(" "),a("h2",{attrs:{id:"二、jquery-post上传头像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、jquery-post上传头像"}},[e._v("#")]),e._v(" 二、jQuery+post上传头像")]),e._v(" "),a("h3",{attrs:{id:"_1、html部分-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、html部分-2"}},[e._v("#")]),e._v(" 1、HTML部分")]),e._v(" "),a("pre",[a("code",[e._v('<div>\n    <img id="img-box" style="border: 1px solid gray; width: 100px; height: 100px;" src=""/>\n\n    <input type="file" name="newHeadImage" id="newHeadImage" value="" />\n\n    <input class="upload-file" type="button" value="上传头像"/>\n</div>\n')])]),e._v(" "),a("h3",{attrs:{id:"_2、jquery实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、jquery实现"}},[e._v("#")]),e._v(" 2、jQuery实现")]),e._v(" "),a("pre",[a("code",[e._v('\x3c!--  引入jQuery文件  --\x3e\n<script src="jquery-1.9.1.min.js" type="text/javascript" charset="utf-8"><\/script>\n\x3c!--  引入接口文件  --\x3e\n<script src="interface.js" type="text/javascript" charset="utf-8"><\/script>\n<script type="text/javascript">\n    \n    \n    //选择图片的处理\n    var tag = document.querySelector("#newHeadImage");\n    tag.addEventListener("change",function(){\n        //1、获取选择的文件,图片\n        if(tag.files.length == 0){\n            alert("没有选择图片")\n            return\n        }\n        var uploadFile = tag.files[0];\n        \n        //2、从文件对象获取本地路径src\n        var src = window.URL.createObjectURL(uploadFile);\n        \n        //3、显示图片\n        var imgBox = document.getElementById("img-box")\n        imgBox.src = src;\n    })\n    \n    //确认更换头像的事件处理\n    $(".upload-file").click(function () {                \n        //1、获取图片输入框\n        var tag = document.getElementById("newHeadImage");                        \n                \n        //2、获取选择的文件,图片\n        //input file类型的标签中, 所有的文件放在files属性中, 这个属性是个数组\n        if(tag.files.length == 0){\n            alert("没有选择图片")\n            return\n        }\n        var uploadFile = tag.files[0];\n        \n        //C.生成FormData. 生成了form表单\n        var formData = new FormData();\n        formData.append("m","user")\n        formData.append("a","changeHeadImage")\n        formData.append("userId","1")\n        formData.append("newHeadImage",uploadFile);\n        \n        //D.发起post请求   vue: this.$http.post()                \n        $.ajax({\n            type:"post",\n            url:changeHeadImageUrl,\n            async:true,\n            data:formData,\n            //processData为真, 数据转化为字符串传递  上传文件, 设置为false\n            processData:false,\n            contentType:false\n        }).done(function (r) {\n            alert(r)\n        });\n        \n    })\n                \n<\/script>\n')])]),e._v(" "),a("h2",{attrs:{id:"三、vue-post上传头像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、vue-post上传头像"}},[e._v("#")]),e._v(" 三、vue+post上传头像")]),e._v(" "),a("h3",{attrs:{id:"_1、html部分-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、html部分-3"}},[e._v("#")]),e._v(" 1、HTML部分")]),e._v(" "),a("pre",[a("code",[e._v('\x3c!--view--\x3e\n<div id="app">\n    <div>\n        <img class="head-image" v-bind:src="src"/><br>\n        <input id="headImageTag" type="file" v-on:change="dealChange" multiple="multiple"/>\n    </div>\n    <div>\n        <button v-on:click="dealUploadImage">修改头像</button>\n    </div>                \n</div>\n')])]),e._v(" "),a("h3",{attrs:{id:"_2、vue部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、vue部分"}},[e._v("#")]),e._v(" 2、Vue部分")]),e._v(" "),a("pre",[a("code",[e._v('\x3c!--  引入vue文件  --\x3e\n<script src="vue/vue.js" type="text/javascript" charset="utf-8"><\/script>\n<script src="vue/vue-resource.js" type="text/javascript" charset="utf-8"><\/script>\n<script src="vue/vue-router.js" type="text/javascript" charset="utf-8"><\/script>\n\x3c!--  引入接口文件  --\x3e\n<script src="interface.js" type="text/javascript" charset="utf-8"><\/script>\n\n<script type="text/javascript">            \n    //model\n    var data = {\n        src:""\n    }\n    \n    //ViewModel\n    var app = new Vue({\n        el:"#app",\n        data:data,\n        methods:{\n            dealUploadImage:function(){                        \n                //1、获取图片输入框\n                var tag = document.getElementById("headImageTag");                        \n                \n                //2、获取选择的文件,图片\n                if(tag.files.length == 0){\n                    alert("没有选择图片")\n                    return\n                }\n                var uploadFile = tag.files[0];                        \n                \n                //3、生成FormData. 生成了form表单\n                var formData = new FormData();\n                formData.append("m","user")\n                formData.append("a","changeHeadImage")\n                formData.append("userId","1")\n                formData.append("newHeadImage",uploadFile);                        \n                \n                //D.发起post请求\n                var url = changeHeadImageUrl;\n                this.$http.post(url,formData,function () {\n                    \n                }).then(function (r) {                            \n                    var jsonObject = r.data;                            \n                })                        \n            },\n            dealChange:function(){\n                //1、获取图片输入框\n                var tag = document.getElementById("headImageTag");\n                \n                //2、获取选择的文件,图片\n                if(tag.files.length == 0){\n                    alert("没有选择图片")\n                    return\n                }\n                var uploadFile = tag.files[0];\n                \n                //3、从文件对象获取本地路径src\n                var src = window.URL.createObjectURL(uploadFile)\n            \n                //4、显示图片\n                this.src = src\n            }\n        }\n    });\n\n<\/script>\n')])])])}),[],!1,null,null,null);t.default=r.exports}}]);